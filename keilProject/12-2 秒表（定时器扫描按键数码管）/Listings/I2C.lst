C51 COMPILER V9.54   I2C                                                                   03/21/2025 16:23:45 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE I2C
OBJECT MODULE PLACED IN .\Objects\I2C.obj
COMPILER INVOKED BY: D:\KEIL 5C51\C51\BIN\C51.EXE I2C.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\I2C
                    -.lst) OBJECT(.\Objects\I2C.obj)

line level    source

   1          #include <REGX52.H>
   2          
   3          sbit I2C_SCL=P2^1;
   4          sbit I2C_SDA=P2^0;
   5          
   6          
   7          /**
   8            * @brief  I2C开始
   9            * @param  无
  10            * @retval 无
  11            */
  12          void I2C_Start(void)
  13          {
  14   1              I2C_SDA=1;
  15   1              I2C_SCL=1;
  16   1              I2C_SDA=0;      
  17   1              I2C_SCL=0;
  18   1      }
  19          
  20          
  21          /**
  22            * @brief  I2C停止
  23            * @param  无
  24            * @retval 无
  25            */
  26          void I2C_Stop(void)
  27          {
  28   1              I2C_SDA=0;
  29   1              I2C_SCL=1;
  30   1              I2C_SDA=1;      
  31   1      }       
  32          
  33          
  34          /**
  35            * @brief  I2C发送一个字节
  36            * @param  Byte 要发送的字节
  37            * @retval 无
  38            */
  39          void I2C_SendByte(unsigned char Byte)
  40          {
  41   1              unsigned char i;
  42   1              for(i=0;i<8;i++)
  43   1              {
  44   2                      I2C_SDA=Byte&(0x80>>i);
  45   2                      I2C_SCL=1;
  46   2                      I2C_SCL=0;      
  47   2              }
  48   1      }
  49          
  50          
  51          /**
  52            * @brief  I2C接收一个字节
  53            * @param  无
  54            * @retval 接收到的一个字节数据
C51 COMPILER V9.54   I2C                                                                   03/21/2025 16:23:45 PAGE 2   

  55            */
  56          unsigned char I2C_ReceiveByte(void)
  57          {
  58   1              unsigned char Byte=0x00;
  59   1              unsigned char i;
  60   1              I2C_SDA=1;
  61   1              for(i=0;i<8;i++)
  62   1              {
  63   2                      I2C_SCL=1;
  64   2                      if(I2C_SDA){Byte|=(0x80>>i);}
  65   2                      I2C_SCL=0;              
  66   2              }
  67   1              return Byte;
  68   1      }
  69          
  70          
  71          /**
  72            * @brief  I2C发送应答
  73                  * @param  AckBit  应答位，0为应答，1为不应答
  74            * @retval 无
  75            */
  76          unsigned char I2C_SendAck(unsigned char AckBit)
  77          {
  78   1              I2C_SDA=AckBit;
  79   1              I2C_SCL=1;
  80   1              I2C_SCL=0;
  81   1      }
*** WARNING C173 IN LINE 81 OF I2C.c: missing return-expression
  82          
  83          
  84          /**
  85            * @brief  I2C接收应答
  86            * @param  无
  87            * @retval AckBit  接收到的应答位，0为应答，1为不应答
  88            */
  89          unsigned char I2C_ReceiveAck(void)
  90          {
  91   1              unsigned char AckBit=0;
  92   1              I2C_SDA=1;
  93   1              I2C_SCL=1;
  94   1              AckBit=I2C_SDA;
  95   1              I2C_SCL=0;
  96   1              return AckBit;
  97   1      }
  98          
  99          
 100          
 101          
 102          
 103          
*** WARNING C290 IN LINE 81 OF I2C.c: missing return value


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    109    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.

C51 COMPILER V9.54   I2C                                                                   03/21/2025 16:23:45 PAGE 3   


C51 COMPILATION COMPLETE.  2 WARNING(S),  0 ERROR(S)
